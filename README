ПРОЕКТ ПО КЛАССИФИКАЦИИ ТАБЛЕТОК

Активация виртуальной среды, установка зависимостей
# Домашняя машина на windows
#.venv\Scripts\activate.bat 

source .venv/bin/activate
pip install -r requirements.txt

#Скачивание сырых данных
python -m src.get_raw_data

#Предобработка данных и подготовка для обучения
python -m src.data_preprocessing

#Объявление модели
python -m src.model_efficientnet

#Обучение CNN-модели
python -m src.model_train

#Оценка CNN-модели
python -m src.model_eval



Выводы по проделанной работе:

- Были опробованы различные архитектуры CNN-моделей (ResNet, EfficientNet, DenseNet).
- Лучшие результаты показала модель EfficientNetB4 с дообучением на наших данных. Результаты сравнимы с трансформером ViT (у него тоже было около 83% на валидации), но при этом модель EfficientNetB0 гораздо легче и быстрее в обучении и инференсе.
- Были реализованы методы дополнительной аугментации данных для повышения качества модели. Опытным путем было проверено, что 4 аугментации (оригинал, горизонтальное отражение, вертикальное отражение, оба отражения) дают наилучший результат.
- Для тестирования модели была реализована техника TTA (Test Time Augmentation), которая позволила дополнительно повысить точность классификации.
- В результате проделанной работы была достигнута точность классификации более 75% на тестовом наборе данных.
- Самые сложные для классификации таблетки были выявлены и проанализирован: это очень похожие по внешнему виду белые таблетки с минимальными отличиями в форме и размерах.

# Результаты экспериментов можно найти в папке results.
Отвыты на вопрсоы:

1) Модель ошибается чаще всего на следующих 5 классах:
- cataflam_50_mg  
- normodipine_5_mg 
- lactiv_plus 
- teva_ambrobene_30_mg
- enterol_250_mg 
2) Модель может ошибаться на этих классах, потому что мало данных, потому что какие-то таблетки очень сильно похожи (например, Энтерол и Лакитв Плюс, которые представляют из себя 2 почти одинаковые капсулы)
Либо это просто белые круглые или овальные таблетки без отличительных черт.
3) Модель не совершает ошибок на следующих классах:['acc_long_600_mg', 'novo_c_plus', 'kalium_r', 'koleszterin_kontroll', 'lactamed', 'lordestin_5_mg', 'advil_ultra_forte', 'mezym_forte_10_000_egyseg', 'milgamma', 'naprosyn_250_mg']
4) Модель распознаёт безошибочно эти классы, потому что у них есть больше отличительных черт (цвет, форма, надписи на таблетках).
5) Точность классификатора можно улучшить, если собрать больше данных по сложным для классификации классам и добавить аугментаций.
Также можно взять более тяжелую модель (ViT, EfficientNetB7), либо по отдеьности их либо настекать друг на друга (я пробовала трансформер плюс EfficientNet), получается неплохой результат, но обучение и инференс занимают очень много времени.
Также возможно попробовать Focal Loss для сильно похожих таблеток.
6) Можно проанализировать результаты и ошибки модели такими дополнительными способами:
- Провести более тщательный анализ ошибок, чтобы понять, какие классы чаще всего путаются между собой
- Посмотреть по слоям, каике признаки извлекаются, а потом может как-то это использовать при работе со сложными таблетками.